webpackJsonp([3],{"1Hw2":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),r=s.n(a),o=s("//Fk"),n=s.n(o),c=s("Xxa5"),i=s.n(c),l=s("exGp"),p=s.n(l),d=s("bS7a"),u=s("k3x/"),m=s("E4LH"),v={mixins:[d.a],props:{},data:function(){return{refresh:{b64s:"",id:""},show:!0,count:"",timer:null,loginForm:{sidentify:"",code:"",phone:""}}},watch:{},computed:{},methods:{onSubmit:function(){var e=this;this.rules().then(function(t){t&&e.next()})},next:function(){this.$emit("next",{reset_phone:this.loginForm.phone,reset_code:this.loginForm.code})},rules:function(){var e=this;return p()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e.loginForm.phone){t.next=6;break}if(Object(m.d)(e.loginForm.phone)){t.next=4;break}return e.$toast("请填写正确手机号"),t.abrupt("return",!1);case 4:t.next=8;break;case 6:return e.$toast("手机号不能为空"),t.abrupt("return",!1);case 8:if(0===e.securityLevel){t.next=21;break}if(""===e.loginForm.sidentify){t.next=19;break}return t.next=12,e.valideCode();case 12:if(t.sent.data.verify_status){t.next=17;break}return e.refreshCode(),e.$toast("请填写正确的图形码"),t.abrupt("return",!1);case 17:t.next=21;break;case 19:return e.$toast("图形码不能为空"),t.abrupt("return",!1);case 21:if(""===e.loginForm.code){t.next=27;break}if(Object(m.e)(e.loginForm.code)){t.next=25;break}return e.$toast("请填写正确的验证码"),t.abrupt("return",!1);case 25:t.next=29;break;case 27:return e.$toast("验证码不能为空"),t.abrupt("return",!1);case 29:return t.abrupt("return",!0);case 30:case"end":return t.stop()}},t,e)}))()},getCode:function(){var e=this;if(!Object(m.d)(e.loginForm.phone))return e.$toast("请先填写手机号"),!1;e.valideCode().then(function(t){if(!t.data.verify_status)return e.$toast("请先填写正确的图形码"),!1;e.sendText()})},valideCode:function(){var e=this;return p()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.a)(r()({id:e.refresh.id,value:e.loginForm.sidentify}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,e)}))()},sendText:function(){var e=this,t=this;Object(u.b)(t.loginForm.phone).then(function(s){e.$toast.success("发送成功"),t.countdown()})},countdown:function(){var e=this;this.timer||(this.count=60,this.show=!1,this.timer=setInterval(function(){e.count>0&&e.count<=60?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)},1e3))}},created:function(){},mounted:function(){}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("form",{ref:"form-wrapper",staticClass:"form-wrapper",attrs:{action:""}},[s("div",{staticClass:"input-wrapper"},[s("div",{staticClass:"label"},[e._v("手机号")]),e._v(" "),s("div",{staticClass:"text-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.phone,expression:"loginForm.phone"}],attrs:{type:"text",placeholder:"请输入手机号"},domProps:{value:e.loginForm.phone},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"phone",t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"input-wrapper"},[s("div",{staticClass:"label"},[e._v("图形码")]),e._v(" "),s("div",{staticClass:"text-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.sidentify,expression:"loginForm.sidentify"}],attrs:{type:"text",placeholder:"请输入图形码的答案"},domProps:{value:e.loginForm.sidentify},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"sidentify",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"code",on:{click:e.refreshCode}},[s("van-image",{attrs:{width:"100%",height:"100%","lazy-load":"",src:e.refresh.b64s}})],1)]),e._v(" "),s("div",{staticClass:"input-wrapper"},[s("div",{staticClass:"label"},[e._v("验证码")]),e._v(" "),s("div",{staticClass:"text-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.code,expression:"loginForm.code"}],attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:e.loginForm.code},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"code",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"getValid"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],on:{click:e.getCode}},[e._v("获取验证码")]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+"s后重新发送")])])]),e._v(" "),s("div",{staticClass:"submit-wrapper"},[s("button",{staticClass:"submit",attrs:{type:"submit"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v("\n        下一步\n      ")])])])])},staticRenderFns:[]};var f=s("VU/8")(v,h,!1,function(e){s("TaB6")},"data-v-6f129c27",null).exports,w={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"app-container"})},staticRenderFns:[]};var g=s("VU/8")({components:{},props:{},data:function(){return{form:{}}},watch:{},computed:{},methods:{},created:function(){},mounted:function(){}},w,!1,function(e){s("8X81")},"data-v-ca951922",null).exports,x={components:{},props:{loadingState:{type:Boolean,default:!1}},data:function(){return{pwdType:"password",checkPassType:"password",passwordForm:{pass:"",checkPass:""}}},watch:{},computed:{},methods:{rules:function(){var e=this;return p()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e.passwordForm.pass){t.next=6;break}if(Object(m.c)(e.passwordForm.pass)){t.next=4;break}return e.$toast("请输入至少6位"),t.abrupt("return",!1);case 4:t.next=8;break;case 6:return e.$toast("请输入密码"),t.abrupt("return",!1);case 8:if(Object(m.c)(e.passwordForm.checkPass)){t.next=13;break}return e.$toast("请再次输入密码"),t.abrupt("return",!1);case 13:if(e.passwordForm.checkPass===e.passwordForm.pass){t.next=16;break}return e.$toast("两次输入密码不一致!"),t.abrupt("return",!1);case 16:return t.abrupt("return",!0);case 17:case"end":return t.stop()}},t,e)}))()},updatePassword:function(e){var t=this;this.rules().then(function(e){e&&t.next()})},next:function(){this.$emit("next",{reset_password:this.passwordForm.pass})},showPwd:function(e){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},showcheckPass:function(){"password"===this.checkPassType?this.checkPassType="":this.checkPassType="password"}},created:function(){},mounted:function(){}},k={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("form",{ref:"form-wrapper",staticClass:"form-wrapper",staticStyle:{"padding-top":"20px"},attrs:{action:""}},[s("div",{staticClass:"input-wrapper"},[s("div",{staticClass:"label"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"text-input"},["checkbox"===e.pwdType?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.pass,expression:"passwordForm.pass"}],attrs:{placeholder:"请设定登录密码",type:"checkbox"},domProps:{checked:Array.isArray(e.passwordForm.pass)?e._i(e.passwordForm.pass,null)>-1:e.passwordForm.pass},on:{change:function(t){var s=e.passwordForm.pass,a=t.target,r=!!a.checked;if(Array.isArray(s)){var o=e._i(s,null);a.checked?o<0&&e.$set(e.passwordForm,"pass",s.concat([null])):o>-1&&e.$set(e.passwordForm,"pass",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.passwordForm,"pass",r)}}}):"radio"===e.pwdType?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.pass,expression:"passwordForm.pass"}],attrs:{placeholder:"请设定登录密码",type:"radio"},domProps:{checked:e._q(e.passwordForm.pass,null)},on:{change:function(t){return e.$set(e.passwordForm,"pass",null)}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.pass,expression:"passwordForm.pass"}],attrs:{placeholder:"请设定登录密码",type:e.pwdType},domProps:{value:e.passwordForm.pass},on:{input:function(t){t.target.composing||e.$set(e.passwordForm,"pass",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"icon-right"},[s("svg-icon",{attrs:{"icon-class":"eye"},on:{click:e.showPwd}})],1)]),e._v(" "),s("div",{staticClass:"input-wrapper"},[s("div",{staticClass:"label"},[e._v("确认密码")]),e._v(" "),s("div",{staticClass:"text-input"},["checkbox"===e.checkPassType?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.checkPass,expression:"passwordForm.checkPass"}],attrs:{placeholder:"请再输入一次登录密码",type:"checkbox"},domProps:{checked:Array.isArray(e.passwordForm.checkPass)?e._i(e.passwordForm.checkPass,null)>-1:e.passwordForm.checkPass},on:{change:function(t){var s=e.passwordForm.checkPass,a=t.target,r=!!a.checked;if(Array.isArray(s)){var o=e._i(s,null);a.checked?o<0&&e.$set(e.passwordForm,"checkPass",s.concat([null])):o>-1&&e.$set(e.passwordForm,"checkPass",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.passwordForm,"checkPass",r)}}}):"radio"===e.checkPassType?s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.checkPass,expression:"passwordForm.checkPass"}],attrs:{placeholder:"请再输入一次登录密码",type:"radio"},domProps:{checked:e._q(e.passwordForm.checkPass,null)},on:{change:function(t){return e.$set(e.passwordForm,"checkPass",null)}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.checkPass,expression:"passwordForm.checkPass"}],attrs:{placeholder:"请再输入一次登录密码",type:e.checkPassType},domProps:{value:e.passwordForm.checkPass},on:{input:function(t){t.target.composing||e.$set(e.passwordForm,"checkPass",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"icon-right"},[s("svg-icon",{attrs:{"icon-class":"eye"},on:{click:e.showcheckPass}})],1)]),e._v(" "),s("div",{staticClass:"submit-wrapper"},[s("van-button",{staticClass:"submit",attrs:{type:"submit",loading:e.loadingState},on:{click:function(t){return t.preventDefault(),e.updatePassword(t)}}},[e._v("下一步")])],1)])},staticRenderFns:[]};var b=s("VU/8")(x,k,!1,function(e){s("jaA0")},"data-v-ff4d1d36",null).exports,_=s("vMJZ"),F={components:{PhoneForm:f,EmailForm:g,PasswordForm:b},mixins:[d.d],props:{},data:function(){return{success:!1,show:!1,actions:[{name:"手机号找回"}],state:!1,loadingState:!1,activeName:Number(localStorage.getItem("reset_index"))||0,actionVal:"手机号找回"}},watch:{},computed:{},methods:{removeLocalStorage:function(){localStorage.removeItem("reset_index"),localStorage.removeItem("reset_phone"),localStorage.removeItem("reset_code"),localStorage.removeItem("reset_password"),this.$router.go(-1)},onSelect:function(e){console.log(e.name),this.show=!1,this.actionVal=e.name},onCancel:function(){this.$toast("取消")},moreState:function(e){var t=this;return new n.a(function(e,s){t.state&&(t.state=!1,e()),s()})},next:function(e){var t=this;for(var s in e){var a=r()(e);localStorage.setItem(s,a)}var o=this.activeName;1!==o?(o++,this.activeName=o,this.state=!0):(this.loadingState=!0,Object(_.g)({phone_num:JSON.parse(localStorage.getItem("reset_phone")).reset_phone,password:this.encryption(JSON.parse(localStorage.getItem("reset_password")).reset_password),code:JSON.parse(localStorage.getItem("reset_code")).reset_code}).then(function(e){1===e.status_code&&(t.success=!0,t.loadingState=!1,o++,t.activeName=o,t.state=!0)})),o<2&&localStorage.setItem("reset_index",o)}},created:function(){},mounted:function(){}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("van-tabs",{attrs:{"before-change":e.moreState,"title-inactive-color":"rgb(255,255,255,0.6)","title-active-color":"#fff","line-width":"65px",color:"#ffcc7c",background:"#95c9ff",animated:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("van-tab",{attrs:{title:"1.填写账号"}},[s("van-cell",{attrs:{"is-link":"",title:"请选择找回方式",value:e.actionVal},on:{click:function(t){e.show=!0}}}),e._v(" "),s("phone-form",{directives:[{name:"show",rawName:"v-show",value:"手机号找回"==e.actionVal,expression:"actionVal == `手机号找回`"}],on:{next:e.next}}),e._v(" "),s("email-form",{directives:[{name:"show",rawName:"v-show",value:"邮箱找回"==e.actionVal,expression:"actionVal == `邮箱找回`"}],on:{next:e.next}})],1),e._v(" "),s("van-tab",{attrs:{title:"2.重置密码"}},[s("password-form",{attrs:{loadingState:e.loadingState},on:{next:e.next}})],1),e._v(" "),s("van-tab",{attrs:{title:"3.设置完成"}},[s("div",{staticClass:"success_wrapper"},[s("div",{staticClass:"text-wrpper"},[s("div",{staticClass:"icon-wrapper"},[e.success?s("i",{staticClass:"el-icon-success i_success"}):s("i",{staticClass:"el-icon-error i_err"})]),e._v(" "),e.success?s("div",{staticClass:"text"},[e._v("您的密码已设置成功")]):s("div",{staticClass:"text"},[e._v("很遗憾，密码重置失败")])]),e._v(" "),s("el-button",{staticClass:"form-button",attrs:{type:"primary"},on:{click:e.removeLocalStorage}},[e._v("返回")])],1)])],1),e._v(" "),s("van-action-sheet",{attrs:{actions:e.actions,"cancel-text":"取消","close-on-click-action":""},on:{select:e.onSelect,cancel:e.onCancel},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)},staticRenderFns:[]};var C=s("VU/8")(F,y,!1,function(e){s("KOjv")},"data-v-52afb7f3",null);t.default=C.exports},"8X81":function(e,t){},KOjv:function(e,t){},TaB6:function(e,t){},jaA0:function(e,t){}});
//# sourceMappingURL=3.46c682d2c8b45ffd0129.js.map